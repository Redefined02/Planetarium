<html>
	<head>
		<title>Earth model</title>
		<style>
			body {
				font-family: Monospace;
				background-color: #000;
				color: #fff;
				margin: 0px;
				overflow: hidden;
			}
			canvas {
				width: 100%; height: 100%
			}
			#info {
				position: absolute;
				top: 10px;
				width: 100%;
				text-align: center;
				z-index: 100;
				display:block;
			}
			#info a { color: #f00; font-weight: bold; text-decoration: underline; cursor: pointer }
		</style>
	</head>
  <body>
    <div id="container"></div>
		<div id="info">
			Earth model</br>
			<a href="index.html">Return to Solar System</a></br>
			Other models <a href="sun.html">Sun</a> - <a href="mercury.html">Mercury</a> - <a href="venus.html">Venus</a> - <a href='mars.html'>Mars</a> - <a href="jupiter.html">Jupiter</a></br>
			<a href="saturn.html">Saturn</a> - <a href="uranus.html">Uranus</a> - <a href="neptune.html">Neptune</a> - <a href="pluto.html">Pluto</a>
		</div>
		<script src="js/three.min.js"></script>
    <script src="lib/examples/js/renderers/Projector.js"></script>
    <script src="lib/examples/js/renderers/CanvasRenderer.js"></script>
    <script src="lib/examples/js/libs/stats.min.js"></script>
    <script>
			var camera, bgCamera, scene, bgScene, renderer, container, stats;
			var mouseX = 0, mouseY = 0;
			var windowHalfX = window.innerWidth / 2;
			var windowHalfY = window.innerHeight / 2;

			init();
			animate();

      function init(){
				container = document.getElementById('container');
				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 2000 );
				camera.position.z = 500;
				scene = new THREE.Scene();

        renderer = new THREE.CanvasRenderer();
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(window.innerWidth, window.innerHeight);
        container.appendChild(renderer.domElement);

				bgScene = new THREE.Scene();
				bgCamera = new THREE.Camera();
				bgScene.add(bgCamera);

				var loader = new THREE.TextureLoader();
				loader.setCrossOrigin("");
				var maxAniso = renderer.getMaxAnisotropy();

				// Backdrop
				var plane = new THREE.PlaneGeometry(2, 2, 0);
				bgTexture = loader.load("http://i.imgur.com/yTICj8s.jpg");
				bgTexture.anisotropy = maxAniso;
				var planeMat = new THREE.MeshBasicMaterial({map:bgTexture});
				var starfield = new THREE.Mesh(plane, planeMat);
				starfield.material.depthTest = false;
				starfield.material.depthWrite = false;
				bgScene.add(starfield);

				// Model
				var earthGeo = new THREE.SphereGeometry(200, 20, 20);
				var earthTexture = loader.load('http://i.imgur.com/NPI2Xq8.jpg');
				var specMap = loader.load('http://i.imgur.com/Th0w4H1.jpg');
				var bMap = loader.load('http://i.imgur.com/FrJlVaN.jpg');
				earthTexture.anisotropy = maxAniso;
				var earthMat = new THREE.MeshPhongMaterial({
					//specular: 0x222222,
					bumpMap: bMap,
					bumpScale: 1,
					map: earthTexture,
					//specularMap: specMap,
					overdraw: 0.5
				});
				var earth = new THREE.Mesh(earthGeo, earthMat);
				scene.add(earth);

				container.appendChild(renderer.domElement);
				stats = new Stats();
				container.appendChild(stats.dom);
				document.addEventListener('mousemove', onDocumentMouseMove, false);
				window.addEventListener('resize', onWindowResize, false);
			}

			function onWindowResize() {
				windowHalfX = window.innerWidth / 2;
				windowHalfY = window.innerHeight / 2;
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize(window.innerWidth, window.innerHeight);
			}

			function onDocumentMouseMove( event ) {
				mouseX = (event.clientX - windowHalfX);
				mouseY = (event.clientY - windowHalfY);
			}

			function animate() {
				requestAnimationFrame(animate);
				render();
				stats.update();
			}

			function render() {
				camera.position.x += ( mouseX - camera.position.x ) * 0.05;
				camera.position.y += ( - mouseY - camera.position.y ) * 0.05;
				camera.lookAt(scene.position);
				scene.rotation.y -= 0.005;

				renderer.autoClear = false;
				renderer.clear();

				renderer.render(bgScene, bgCamera);
				renderer.render(scene, camera);
			}
    </script>
  </body>
</html>
